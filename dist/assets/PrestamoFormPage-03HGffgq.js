import{f as _,h as E,j as e,B as a,T as i,D as j}from"./index--atX_XUv.js";import{u as T,d as D}from"./Save-BjSFydXk.js";import{d as I}from"./ArrowBack-lqHG2J96.js";import{d as M}from"./InfoOutlined-vupGoHqQ.js";import{u as S,M as l}from"./usePrestamosStore-Bm7nHmuX.js";import{A as b}from"./AppButton-DGApZOMm.js";import{T as n}from"./TextField-BTw6FAe8.js";import{T as q}from"./Tooltip-CL_KIFp2.js";import"./prestamosApi-D9fRTWkx.js";import"./Button-C1kfnTXj.js";const k=()=>{var u,c,p,x;const m=_(),{create:f,loading:A,error:d}=S(),r=E(o=>o.user),{register:s,handleSubmit:g,formState:{errors:t}}=T({defaultValues:{id_prestatario:(r==null?void 0:r.role)==="EMPLEADO"||(r==null?void 0:r.role)==="ADMIN"?void 0:(r==null?void 0:r.id_prestatario)??void 0,monto:0,nro_cuotas:12,tipo_interes:"MEDIA"}}),y=async o=>{const h=await f({id_prestatario:o.id_prestatario,monto:Number(o.monto),nro_cuotas:Number(o.nro_cuotas),tipo_interes:o.tipo_interes});h&&m(`/prestamos/${h.id}`)},v=(r==null?void 0:r.role)==="EMPLEADO"||(r==null?void 0:r.role)==="ADMIN";return e.jsxs(a,{children:[e.jsxs(a,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(i,{variant:"h5",children:"Solicitar nuevo préstamo"}),e.jsx(b,{startIcon:e.jsx(I,{}),onClick:()=>m("/prestamos"),children:"Volver"})]}),e.jsx(j,{severity:"info",sx:{mb:2},children:"Recuerda: cada prestatario puede tener como máximo 2 préstamos activos. Si ya tiene 2, el sistema rechazará automáticamente la nueva solicitud."}),d&&e.jsx(j,{severity:"error",sx:{mb:2},children:d}),e.jsxs(a,{component:"form",onSubmit:g(y),maxWidth:480,display:"flex",flexDirection:"column",gap:2,children:[v&&e.jsx(n,{label:"ID prestatario",type:"number",fullWidth:!0,error:!!t.id_prestatario,helperText:(u=t.id_prestatario)==null?void 0:u.message,...s("id_prestatario",{required:"El ID del prestatario es requerido para empleados",valueAsNumber:!0})}),e.jsx(n,{label:"Monto",type:"number",fullWidth:!0,error:!!t.monto,helperText:((c=t.monto)==null?void 0:c.message)??"El monto debe ser mayor a 0.",...s("monto",{required:"El monto es requerido",valueAsNumber:!0,min:{value:1,message:"El monto debe ser positivo"}})}),e.jsx(n,{label:"Número de cuotas",type:"number",fullWidth:!0,error:!!t.nro_cuotas,helperText:((p=t.nro_cuotas)==null?void 0:p.message)??"Las cuotas se generan automáticamente en el backend según el número indicado.",...s("nro_cuotas",{required:"El número de cuotas es requerido",valueAsNumber:!0,min:{value:1,message:"Debe haber al menos 1 cuota"}})}),e.jsxs(n,{select:!0,label:"Tipo de interés",fullWidth:!0,error:!!t.tipo_interes,helperText:((x=t.tipo_interes)==null?void 0:x.message)??"Selecciona el tipo de interés según el nivel de riesgo y el plazo deseado.",InputProps:{endAdornment:e.jsx(q,{title:e.jsxs(e.Fragment,{children:[e.jsxs(i,{variant:"body2",children:[e.jsx("strong",{children:"BAJA"}),": menor tasa, cuotas más bajas y plazos más largos."]}),e.jsxs(i,{variant:"body2",children:[e.jsx("strong",{children:"MEDIA"}),": equilibrio entre monto total y plazo."]}),e.jsxs(i,{variant:"body2",children:[e.jsx("strong",{children:"ALTA"}),": mayor tasa, cuotas más altas y plazos más cortos."]})]}),children:e.jsx(M,{fontSize:"small",sx:{cursor:"help"}})})},...s("tipo_interes",{required:"El tipo de interés es requerido"}),children:[e.jsx(l,{value:"BAJA",children:"BAJA"}),e.jsx(l,{value:"MEDIA",children:"MEDIA"}),e.jsx(l,{value:"ALTA",children:"ALTA"})]}),e.jsx(a,{display:"flex",justifyContent:"flex-end",gap:1,mt:2,children:e.jsx(b,{startIcon:e.jsx(D,{}),type:"submit",disabled:A,children:"Enviar solicitud"})})]})]})};export{k as PrestamoFormPage,k as default};
